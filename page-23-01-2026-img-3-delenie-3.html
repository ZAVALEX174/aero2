<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>–†–µ–¥–∞–∫—Ç–æ—Ä —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏—Ö —á–µ—Ä—Ç–µ–∂–µ–π (Fabric.js) —Å —Ä–∞–∑–±–∏–µ–Ω–∏–µ–º –ª–∏–Ω–∏–π</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/fabric.js/5.3.0/fabric.min.js"></script>
  <link
    rel="stylesheet"
    href="./styles/style1.css"
  >
</head>
<body>
<div class="container">
  <h1>üìê –†–µ–¥–∞–∫—Ç–æ—Ä —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏—Ö —á–µ—Ä—Ç–µ–∂–µ–π</h1>
  <p class="subtitle">–°–æ–∑–¥–∞–≤–∞–π—Ç–µ —á–µ—Ä—Ç–µ–∂–∏ —Å –ø—Ä–∏–≤—è–∑–∫–æ–π –∫ —Å–µ—Ç–∫–µ, —Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ
    —Å–≤–æ–π—Å—Ç–≤–∞ –æ–±—ä–µ–∫—Ç–æ–≤ –∏ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–π—Ç–µ –≤ JSON
  </p>

  <div class="main-content">
    <div class="left-panel">
      <div id="tools">
        <button
          onclick="activateLineDrawing()"
          id="lineDrawingBtn"
        >
          <span>üìè</span> –õ–∏–Ω–∏—è
        </button>
        <button onclick="splitLinesAtIntersections()">
          <span>‚úÇÔ∏è</span> –†–∞–∑–±–∏—Ç—å –ª–∏–Ω–∏–∏
        </button>
        <button onclick="splitLinesAtSelectedImage()">
          <span>üîó</span> –†–∞–∑–±–∏—Ç—å –ø–æ –æ–±—ä–µ–∫—Ç—É
        </button>
        <button onclick="findIntersectionsOnly()">
          <span>üîç</span> –ü–µ—Ä–µ—Å–µ—á–µ–Ω–∏—è
        </button>
        <button onclick="clearIntersectionPoints()">
          <span>üßπ</span> –û—á–∏—Å—Ç–∏—Ç—å —Ç–æ—á–∫–∏
        </button>
        <button onclick="showAllIntersectionPoints()">
          <span>üîµ</span> –ü–æ–∫–∞–∑–∞—Ç—å —Ç–æ—á–∫–∏
        </button>
        <button
          onclick="toggleContinuousMode()"
          id="continuousModeBtn"
        >
          <span>üîó</span> –ù–µ–ø—Ä–µ—Ä—ã–≤–Ω—ã–π (–í–´–ö–õ)
        </button>
        <button onclick="showLinePropertiesModal()">
          <span>‚öôÔ∏è</span> –°–≤–æ–π—Å—Ç–≤–∞ –ª–∏–Ω–∏–∏
        </button>
        <button onclick="showImagePropertiesModal()">
          <span>üñºÔ∏è</span> –°–≤–æ–π—Å—Ç–≤–∞ –æ–±—ä–µ–∫—Ç–∞
        </button>
        <button
          onclick="showAddImageModal()"
          id="addImageBtn"
        >
          <span>‚ûï</span> –î–æ–±–∞–≤–∏—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ
        </button>
        <button onclick="saveDrawing()">
          <span>üíæ</span> –°–æ—Ö—Ä–∞–Ω–∏—Ç—å
        </button>
        <button onclick="loadDrawing()">
          <span>üìÇ</span> –ó–∞–≥—Ä—É–∑–∏—Ç—å
        </button>
        <button onclick="clearCanvas()">
          <span>üóëÔ∏è</span> –û—á–∏—Å—Ç–∏—Ç—å —Ö–æ–ª—Å—Ç
        </button>
        <button onclick="exportToConsole()">
          <span>üìä</span> –≠–∫—Å–ø–æ—Ä—Ç
        </button>
        <button
          onclick="toggleGrid()"
          id="gridToggleBtn"
        >
          <span>üî≤</span> –°–µ—Ç–∫–∞ (–í–ö–õ)
        </button>
        <button
          onclick="undoAction()"
          id="undoBtn"
        >
          <span>‚Ü©Ô∏è</span> –û—Ç–º–µ–Ω–∏—Ç—å
        </button>
        <button
          onclick="toggleAutoSplitMode()"
          id="autoSplitBtn"
        >
          <span>‚ö°</span> –ê–≤—Ç–æ—Ä–∞–∑–±–∏–≤–∫–∞ (–í–ö–õ)
        </button>
        <!-- –ù–æ–≤–∞—è –∫–Ω–æ–ø–∫–∞ -->
        <button
          onclick="toggleLineSplitMode()"
          id="lineSplitModeBtn"
          class="line-split-mode-btn"
        >
          <span>üéØ</span> –†–µ–∂–∏–º —Ä–∞–∑–±–∏–µ–Ω–∏—è: –ê–í–¢–û
        </button>
      </div>

      <div id="image-tools-container">
        <div class="image-tools-header">
          <h4>üìÅ –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è</h4>
          <button
            onclick="showManageImagesModal()"
            style="padding: 5px 10px; font-size: 11px;"
          >
            <span>‚öôÔ∏è</span> –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
          </button>
        </div>
        <div
          class="image-tools-grid"
          id="imageToolsGrid"
        >
          <!-- –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –∑–∞–ø–æ–ª–Ω—è–µ—Ç—Å—è JavaScript -->
        </div>
      </div>

      <div class="properties-panel">
        <h3>–°–≤–æ–π—Å—Ç–≤–∞ –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ –æ–±—ä–µ–∫—Ç–∞</h3>
        <div id="props-content">
          <p style="color: #7f8c8d; font-style: italic; text-align: center; padding: 20px;">
            –í—ã–±–µ—Ä–∏—Ç–µ –æ–±—ä–µ–∫—Ç –Ω–∞ —á–µ—Ä—Ç–µ–∂–µ –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Å–≤–æ–π—Å—Ç–≤
          </p>
        </div>
      </div>

      <div id="status">
        –ì–æ—Ç–æ–≤–æ –∫ —Ä–∞–±–æ—Ç–µ. –û–±—ä–µ–∫—Ç–æ–≤ –Ω–∞ —á–µ—Ä—Ç–µ–∂–µ: 0
      </div>

      <div class="instructions">
        <h4>üìã –ì–æ—Ä—è—á–∏–µ –∫–ª–∞–≤–∏—à–∏</h4>
        <ul>
          <li><strong>ESC</strong> - –æ—Ç–º–µ–Ω–∞ —Ç–µ–∫—É—â–µ–≥–æ –¥–µ–π—Å—Ç–≤–∏—è</li>
          <li><strong>Delete</strong> - —É–¥–∞–ª–∏—Ç—å –≤—ã–±—Ä–∞–Ω–Ω—ã–π –æ–±—ä–µ–∫—Ç</li>
          <li><strong>Ctrl+S</strong> - —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å —á–µ—Ä—Ç–µ–∂</li>
          <li><strong>Ctrl+O</strong> - –∑–∞–≥—Ä—É–∑–∏—Ç—å —á–µ—Ä—Ç–µ–∂</li>
          <li><strong>Ctrl+Z</strong> - –æ—Ç–º–µ–Ω–∏—Ç—å –ø–æ—Å–ª–µ–¥–Ω–µ–µ –¥–µ–π—Å—Ç–≤–∏–µ</li>
          <li><strong>Ctrl+Y</strong> - –ø–æ–≤—Ç–æ—Ä–∏—Ç—å –æ—Ç–º–µ–Ω–µ–Ω–Ω–æ–µ –¥–µ–π—Å—Ç–≤–∏–µ</li>
          <li><strong>Alt + –ø–µ—Ä–µ—Ç–∞—Å–∫–∏–≤–∞–Ω–∏–µ</strong> - –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏–µ —Ö–æ–ª—Å—Ç–∞</li>
          <li><strong>Shift + –∫–ª–∏–∫</strong> - —Ä–∞–∑–º–µ—Å—Ç–∏—Ç—å –æ–±—ä–µ–∫—Ç</li>
          <li><strong>I</strong> - –Ω–∞–π—Ç–∏ –ø–µ—Ä–µ—Å–µ—á–µ–Ω–∏—è</li>
          <li><strong>Ctrl+Shift+S</strong> - —Ä–∞–∑–±–∏—Ç—å –ª–∏–Ω–∏–∏</li>
          <li><strong>L</strong> - —Ä–∏—Å–æ–≤–∞—Ç—å –ª–∏–Ω–∏—é</li>
          <li><strong>N</strong> - –¥–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ</li>
          <li><strong>G</strong> - —Å–∫—Ä—ã—Ç—å/–ø–æ–∫–∞–∑–∞—Ç—å —Å–µ—Ç–∫—É</li>
          <li><strong>Ctrl+G</strong> - —Å–≥—Ä—É–ø–ø–∏—Ä–æ–≤–∞—Ç—å –æ–±—ä–µ–∫—Ç—ã</li>
          <li><strong>Ctrl+Shift+G</strong> - —Ä–∞–∑–≥—Ä—É–ø–ø–∏—Ä–æ–≤–∞—Ç—å</li>
          <li><strong>A</strong> - –≤–∫–ª—é—á–∏—Ç—å/–≤—ã–∫–ª—é—á–∏—Ç—å –∞–≤—Ç–æ—Ä–∞–∑–±–∏–≤–∫—É</li>
          <li><strong>O</strong> - —Ä–∞–∑–±–∏—Ç—å –ª–∏–Ω–∏–∏ –ø–æ –≤—ã–±—Ä–∞–Ω–Ω–æ–º—É –æ–±—ä–µ–∫—Ç—É</li>
          <li><strong>P</strong> - –ø–æ–∫–∞–∑–∞—Ç—å —Ç–æ—á–∫–∏ –ø–µ—Ä–µ—Å–µ—á–µ–Ω–∏—è</li>
          <li><strong>M</strong> - –ø–µ—Ä–µ–∫–ª—é—á–∏—Ç—å —Ä–µ–∂–∏–º —Ä–∞–∑–±–∏–µ–Ω–∏—è</li>
        </ul>
      </div>
    </div>

    <div class="canvas-container">
      <div id="canvas-container">
        <canvas
          id="fabric-canvas"
          width="1050"
          height="600"
        ></canvas>
      </div>
    </div>
  </div>
</div>

<!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Å–≤–æ–π—Å—Ç–≤ –ª–∏–Ω–∏–∏ -->
<div
  id="linePropertiesModal"
  class="modal"
>
  <div class="modal-content">
    <div class="modal-header">
      <h2 class="modal-title">‚öôÔ∏è –°–≤–æ–π—Å—Ç–≤–∞ –ª–∏–Ω–∏–∏</h2>
      <button
        class="close-modal"
        onclick="closeLinePropertiesModal()"
      >√ó
      </button>
    </div>
    <form
      id="linePropertiesForm"
      class="modal-form"
    >
      <div class="form-row">
        <div class="form-group">
          <label class="form-label">–ù–∞–∑–≤–∞–Ω–∏–µ:</label>
          <input
            type="text"
            id="propertyName"
            placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –ì–ª–∞–≤–Ω–∞—è –±–∞–ª–∫–∞"
            required
          >
        </div>
        <div class="form-group">
          <label class="form-label">–¶–≤–µ—Ç –ª–∏–Ω–∏–∏:</label>
          <input
            type="color"
            id="propertyColor"
            value="#2a9d8f"
          >
        </div>
      </div>

      <div class="form-row">
        <div class="form-group">
          <label class="form-label">–¢–æ–ª—â–∏–Ω–∞ (px):</label>
          <select id="propertyWidth">
            <option value="1">1 px</option>
            <option
              value="2"
              selected
            >2 px
            </option>
            <option value="3">3 px</option>
            <option value="4">4 px</option>
            <option value="5">5 px</option>
          </select>
        </div>
        <div class="form-group">
          <label class="form-label">–¢–∏–ø –ª–∏–Ω–∏–∏:</label>
          <select id="propertyLineType">
            <option
              value="solid"
              selected
            >–°–ø–ª–æ—à–Ω–∞—è
            </option>
            <option value="dashed">–ü—É–Ω–∫—Ç–∏—Ä–Ω–∞—è</option>
            <option value="dotted">–¢–æ—á–µ—á–Ω–∞—è</option>
          </select>
        </div>
      </div>

      <div class="section-divider"></div>

      <div class="form-group">
        <label class="form-label">1. –î–ª–∏–Ω–∞ (L, –º¬≤):</label>
        <input
          type="number"
          id="propertyL"
          step="0.001"
          min="0"
          placeholder="0.5237"
          required
        >
      </div>
      <div class="form-group">
        <label class="form-label">2. –ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç (I):</label>
        <input
          type="number"
          id="propertyI"
          step="0.000001"
          min="0"
          placeholder="0.015327"
          required
        >
      </div>
      <div class="form-group">
        <label class="form-label">3. –ü–∞—Ä–∞–º–µ—Ç—Ä (K, –º):</label>
        <input
          type="number"
          id="propertyK"
          step="0.001"
          min="0"
          placeholder="10.235"
          required
        >
      </div>
      <div class="form-group">
        <label class="form-label">4. –í–µ—Å (W, –∫–≥/–º):</label>
        <input
          type="number"
          id="propertyW"
          step="0.01"
          min="0"
          placeholder="1.0"
          required
        >
      </div>

      <div class="modal-buttons">
        <button
          type="button"
          class="btn btn-secondary"
          onclick="closeLinePropertiesModal()"
        >–û—Ç–º–µ–Ω–∞
        </button>
        <button
          type="submit"
          class="btn btn-primary"
        >–ü—Ä–∏–º–µ–Ω–∏—Ç—å —Å–≤–æ–π—Å—Ç–≤–∞
        </button>
      </div>
    </form>
  </div>
</div>

<!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Å–≤–æ–π—Å—Ç–≤ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è -->
<div
  id="imagePropertiesModal"
  class="modal"
>
  <div class="modal-content">
    <div class="modal-header">
      <h2 class="modal-title">üñºÔ∏è –°–≤–æ–π—Å—Ç–≤–∞ –æ–±—ä–µ–∫—Ç–∞</h2>
      <button
        class="close-modal"
        onclick="closeImagePropertiesModal()"
      >√ó
      </button>
    </div>
    <form
      id="imagePropertiesForm"
      class="modal-form"
    >
      <div class="tab-buttons">
        <button
          type="button"
          class="tab-button active"
          onclick="switchImageTab('basic')"
        >–û—Å–Ω–æ–≤–Ω—ã–µ
        </button>
        <button
          type="button"
          class="tab-button"
          onclick="switchImageTab('technical')"
        >–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ
        </button>
        <button
          type="button"
          class="tab-button"
          onclick="switchImageTab('custom')"
        >–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ
        </button>
      </div>

      <div
        id="imageTabBasic"
        class="tab-content active"
      >
        <div class="form-group">
          <label class="form-label">–ù–∞–∑–≤–∞–Ω–∏–µ:</label>
          <input
            type="text"
            id="imagePropertyName"
            placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –í–µ–Ω—Ç–∏–ª—è—Ç–æ—Ä –ø—Ä–∏—Ç–æ—á–Ω—ã–π"
            required
          >
        </div>
        <div class="form-row">
          <div class="form-group">
            <label class="form-label">–®–∏—Ä–∏–Ω–∞ (px):</label>
            <input
              type="number"
              id="imageWidth"
              step="1"
              min="10"
              max="100"
              placeholder="40"
              required
            >
          </div>
          <div class="form-group">
            <label class="form-label">–í—ã—Å–æ—Ç–∞ (px):</label>
            <input
              type="number"
              id="imageHeight"
              step="1"
              min="10"
              max="100"
              placeholder="40"
              required
            >
          </div>
        </div>
        <div class="form-group">
          <label class="form-label">–ü–æ–≤–æ—Ä–æ—Ç (–≥—Ä–∞–¥—É—Å—ã):</label>
          <input
            type="number"
            id="imageRotation"
            step="1"
            min="0"
            max="360"
            placeholder="0"
          >
        </div>
        <div class="form-group">
          <label class="form-label">–ù–µ–ø—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç—å:</label>
          <input
            type="range"
            id="imageOpacity"
            min="0.1"
            max="1"
            step="0.1"
            value="1"
          >
          <span id="opacityValue">100%</span>
        </div>
      </div>

      <div
        id="imageTabTechnical"
        class="tab-content"
      >
        <div class="form-group">
          <label class="form-label">–¢–∏–ø –æ–±—ä–µ–∫—Ç–∞:</label>
          <select
            id="imageType"
            onchange="updateImageTypeFields()"
          >
            <option value="default">–û–±—ã—á–Ω—ã–π –æ–±—ä–µ–∫—Ç</option>
            <option value="fan">–í–µ–Ω—Ç–∏–ª—è—Ç–æ—Ä</option>
            <option value="fire">–ü–æ–∂–∞—Ä–Ω—ã–π –¥–∞—Ç—á–∏–∫</option>
            <option value="valve">–ö–ª–∞–ø–∞–Ω</option>
            <option value="pump">–ù–∞—Å–æ—Å</option>
            <option value="sensor">–î–∞—Ç—á–∏–∫</option>
          </select>
        </div>
        <div
          id="fanProperties"
          style="display: none;"
        >
          <div class="form-group">
            <label class="form-label">–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤–æ–∑–¥—É—Ö–∞ (–º¬≥/—á):</label>
            <input
              type="number"
              id="imageAirQuantity"
              step="0.1"
              min="0"
              placeholder="100.0"
            >
          </div>
          <div class="form-group">
            <label class="form-label">–°–æ–ø—Ä–æ—Ç–∏–≤–ª–µ–Ω–∏–µ –≤–æ–∑–¥—É—Ö–∞ (–ü–∞):</label>
            <input
              type="number"
              id="imageAirResistance"
              step="0.1"
              min="0"
              placeholder="30.0"
            >
          </div>
        </div>
        <div
          id="fireProperties"
          style="display: none;"
        >
          <div class="form-group">
            <label class="form-label">–¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏—è (¬∞C):</label>
            <input
              type="number"
              id="fireTemperature"
              step="1"
              min="0"
              placeholder="70"
            >
          </div>
          <div class="form-group">
            <label class="form-label">–ó–æ–Ω–∞ –ø–æ–∫—Ä—ã—Ç–∏—è (–º¬≤):</label>
            <input
              type="number"
              id="fireCoverage"
              step="1"
              min="0"
              placeholder="50"
            >
          </div>
        </div>
        <div
          id="valveProperties"
          style="display: none;"
        >
          <div class="form-group">
            <label class="form-label">–î–∏–∞–º–µ—Ç—Ä (–º–º):</label>
            <input
              type="number"
              id="valveDiameter"
              step="1"
              min="0"
              placeholder="50"
            >
          </div>
          <div class="form-group">
            <label class="form-label">–¢–∏–ø –ø—Ä–∏–≤–æ–¥–∞:</label>
            <select id="valveActuator">
              <option value="manual">–†—É—á–Ω–æ–π</option>
              <option value="electric">–≠–ª–µ–∫—Ç—Ä–∏—á–µ—Å–∫–∏–π</option>
              <option value="pneumatic">–ü–Ω–µ–≤–º–∞—Ç–∏—á–µ—Å–∫–∏–π</option>
            </select>
          </div>
        </div>
      </div>

      <div
        id="imageTabCustom"
        class="tab-content"
      >
        <div id="customPropertiesContainer">
          <!-- –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –∑–∞–ø–æ–ª–Ω—è–µ—Ç—Å—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–º–∏ —Å–≤–æ–π—Å—Ç–≤–∞–º–∏ -->
        </div>
        <div style="margin-top: 10px;">
          <button
            type="button"
            class="btn btn-secondary"
            onclick="addCustomPropertyField()"
            style="padding: 8px 12px; font-size: 12px;"
          >
            ‚ûï –î–æ–±–∞–≤–∏—Ç—å —Å–≤–æ–π—Å—Ç–≤–æ
          </button>
        </div>
      </div>

      <div class="modal-buttons">
        <button
          type="button"
          class="btn btn-secondary"
          onclick="closeImagePropertiesModal()"
        >–û—Ç–º–µ–Ω–∞
        </button>
        <button
          type="submit"
          class="btn btn-primary"
        >–ü—Ä–∏–º–µ–Ω–∏—Ç—å —Å–≤–æ–π—Å—Ç–≤–∞
        </button>
      </div>
    </form>
  </div>
</div>

<!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –Ω–æ–≤–æ–≥–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è -->
<div
  id="addImageModal"
  class="modal"
>
  <div class="modal-content">
    <div class="modal-header">
      <h2 class="modal-title">‚ûï –î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ</h2>
      <button
        class="close-modal"
        onclick="closeAddImageModal()"
      >√ó
      </button>
    </div>

    <div class="tab-buttons">
      <button
        type="button"
        class="tab-button active"
        onclick="switchAddImageTab('upload')"
      >–ó–∞–≥—Ä—É–∑–∏—Ç—å
      </button>
      <button
        type="button"
        class="tab-button"
        onclick="switchAddImageTab('url')"
      >–ü–æ URL
      </button>
      <button
        type="button"
        class="tab-button"
        onclick="switchAddImageTab('gallery')"
      >–ì–∞–ª–µ—Ä–µ—è
      </button>
    </div>

    <form
      id="addImageForm"
      class="modal-form"
    >
      <div
        id="uploadTab"
        class="tab-content active"
      >
        <div class="form-group">
          <label class="form-label">–ó–∞–≥—Ä—É–∑–∏—Ç–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ:</label>
          <div
            id="dropArea"
            style="border: 2px dashed #6a11cb; border-radius: 8px; padding: 30px; text-align: center; cursor: pointer; background: #f8f9fa;"
          >
            <span style="font-size: 48px;">üìÅ</span>
            <p style="margin: 10px 0; font-weight: 600; color: #2c3e50;">
              –ü–µ—Ä–µ—Ç–∞—â–∏—Ç–µ —Ñ–∞–π–ª —Å—é–¥–∞
            </p>
            <p style="margin: 0; color: #7f8c8d; font-size: 14px;">–∏–ª–∏ –Ω–∞–∂–º–∏—Ç–µ
              –¥–ª—è –≤—ã–±–æ—Ä–∞ —Ñ–∞–π–ª–∞
            </p>
            <input
              type="file"
              id="fileInput"
              accept="image/*"
              style="display: none;"
            >
          </div>
          <div class="hint">–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è —Ñ–æ—Ä–º–∞—Ç—ã: PNG, JPG, SVG, GIF.
            –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä: 2MB
          </div>
        </div>

        <div
          id="previewContainer"
          style="display: none;"
        >
          <h4 style="margin: 15px 0 10px 0;">–ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä:</h4>
          <img
            id="imagePreview"
            class="preview-image"
            src=""
            alt="–ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä"
          >
          <div
            class="hint"
            style="text-align: center;"
          >–†–∞–∑–º–µ—Ä –±—É–¥–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω 40√ó40 –ø–∏–∫—Å–µ–ª–µ–π
          </div>
        </div>
      </div>

      <div
        id="urlTab"
        class="tab-content"
      >
        <div class="form-group">
          <label class="form-label">URL –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è:</label>
          <input
            type="url"
            id="newImageUrl"
            placeholder="https://example.com/image.png"
          >
          <div class="hint">–£–∫–∞–∂–∏—Ç–µ –ø—Ä—è–º—É—é —Å—Å—ã–ª–∫—É –Ω–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ</div>
        </div>

        <div class="form-group">
          <label class="form-label">–ò–ª–∏ –≤—ã–±–µ—Ä–∏—Ç–µ –∏–∑ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã—Ö:</label>
          <div
            class="image-tools-grid"
            id="standardImagesGrid"
          >
            <!-- –ó–∞–ø–æ–ª–Ω—è–µ—Ç—Å—è JavaScript -->
          </div>
        </div>
      </div>

      <div
        id="galleryTab"
        class="tab-content"
      >
        <div id="galleryContainer">
          <!-- –ó–∞–ø–æ–ª–Ω—è–µ—Ç—Å—è JavaScript -->
        </div>
      </div>

      <div class="section-divider"></div>

      <div class="form-group">
        <label class="form-label">–ù–∞–∑–≤–∞–Ω–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è:</label>
        <input
          type="text"
          id="newImageName"
          placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –î–≤–µ—Ä—å"
          required
        >
      </div>

      <div class="form-row">
        <div class="form-group">
          <label class="form-label">–ò–∫–æ–Ω–∫–∞ (—ç–º–æ–¥–∑–∏):</label>
          <input
            type="text"
            id="newImageIcon"
            placeholder="üö™"
            value="üñºÔ∏è"
            maxlength="2"
          >
        </div>
        <div class="form-group">
          <label class="form-label">–¢–∏–ø –æ–±—ä–µ–∫—Ç–∞:</label>
          <select id="newImageType">
            <option value="default">–û–±—ã—á–Ω—ã–π –æ–±—ä–µ–∫—Ç</option>
            <option value="fan">–í–µ–Ω—Ç–∏–ª—è—Ç–æ—Ä</option>
            <option value="fire">–ü–æ–∂–∞—Ä–Ω—ã–π –¥–∞—Ç—á–∏–∫</option>
            <option value="valve">–ö–ª–∞–ø–∞–Ω</option>
            <option value="pump">–ù–∞—Å–æ—Å</option>
            <option value="sensor">–î–∞—Ç—á–∏–∫</option>
            <option value="door">–î–≤–µ—Ä—å</option>
            <option value="window">–û–∫–Ω–æ</option>
            <option value="equipment">–û–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ</option>
          </select>
        </div>
      </div>

      <div class="form-group">
        <label class="form-label">–û–ø–∏—Å–∞–Ω–∏–µ (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ):</label>
        <textarea
          id="newImageDescription"
          rows="2"
          placeholder="–ö—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è"
        ></textarea>
      </div>

      <div
        id="addImageCustomProps"
        style="display: none;"
      >
        <h4 style="margin: 15px 0 10px 0;">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ —Å–≤–æ–π—Å—Ç–≤–∞:</h4>
        <div id="addImageCustomPropsContainer">
          <!-- –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –∑–∞–ø–æ–ª–Ω—è–µ—Ç—Å—è -->
        </div>
        <div style="margin-top: 10px;">
          <button
            type="button"
            class="btn btn-secondary"
            onclick="addCustomPropertyField('addImage')"
            style="padding: 8px 12px; font-size: 12px;"
          >
            ‚ûï –î–æ–±–∞–≤–∏—Ç—å —Å–≤–æ–π—Å—Ç–≤–æ
          </button>
        </div>
      </div>

      <div class="modal-buttons">
        <button
          type="button"
          class="btn btn-secondary"
          onclick="closeAddImageModal()"
        >–û—Ç–º–µ–Ω–∞
        </button>
        <button
          type="submit"
          class="btn btn-primary"
          id="submitImageBtn"
        >–î–æ–±–∞–≤–∏—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ
        </button>
      </div>
    </form>
  </div>
</div>

<!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏ -->
<div
  id="manageImagesModal"
  class="modal"
>
  <div
    class="modal-content"
    style="max-width: 700px;"
  >
    <div class="modal-header">
      <h2 class="modal-title">‚öôÔ∏è –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏</h2>
      <button
        class="close-modal"
        onclick="closeManageImagesModal()"
      >√ó
      </button>
    </div>

    <div class="tab-buttons">
      <button
        type="button"
        class="tab-button active"
        onclick="switchManageTab('custom')"
      >–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ
      </button>
      <button
        type="button"
        class="tab-button"
        onclick="switchManageTab('default')"
      >–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ
      </button>
      <button
        type="button"
        class="tab-button"
        onclick="switchManageTab('import')"
      >–ò–º–ø–æ—Ä—Ç/–≠–∫—Å–ø–æ—Ä—Ç
      </button>
    </div>

    <div
      id="customImagesTab"
      class="tab-content active"
    >
      <div style="margin-bottom: 15px; display: flex; justify-content: space-between; align-items: center;">
        <p>–í–∞—à–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è:</p>
        <button
          onclick="showAddImageModal(); closeManageImagesModal();"
          class="btn btn-primary"
          style="padding: 8px 12px;"
        >
          ‚ûï –î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤–æ–µ
        </button>
      </div>

      <div
        id="customImagesList"
        class="image-tools-grid"
        style="grid-template-columns: repeat(3, 1fr); max-height: 300px;"
      >
        <!-- –ó–∞–ø–æ–ª–Ω—è–µ—Ç—Å—è JavaScript -->
      </div>

      <div
        class="hint"
        style="margin-top: 10px;"
      >
        –í—Å–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π:
        <span id="customImagesCount">0</span>
      </div>
    </div>

    <div
      id="defaultImagesTab"
      class="tab-content"
    >
      <p>–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è, –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ –≤ —Ä–µ–¥–∞–∫—Ç–æ—Ä:</p>
      <div
        id="defaultImagesList"
        class="image-tools-grid"
        style="grid-template-columns: repeat(3, 1fr); max-height: 300px;"
      >
        <!-- –ó–∞–ø–æ–ª–Ω—è–µ—Ç—Å—è JavaScript -->
      </div>
    </div>

    <div
      id="importExportTab"
      class="tab-content"
    >
      <div class="form-group">
        <h4 style="margin-top: 0;">–≠–∫—Å–ø–æ—Ä—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π</h4>
        <p>–≠–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–π—Ç–µ –≤—Å–µ –≤–∞—à–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –≤ —Ñ–∞–π–ª –¥–ª—è
          —Ä–µ–∑–µ—Ä–≤–Ω–æ–≥–æ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è –∏–ª–∏ –ø–µ—Ä–µ–Ω–æ—Å–∞:
        </p>
        <button
          onclick="exportCustomImages()"
          class="btn btn-primary"
          style="width: 100%; margin-bottom: 15px;"
        >
          üì• –≠–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
        </button>
      </div>

      <div class="form-group">
        <h4>–ò–º–ø–æ—Ä—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π</h4>
        <p>–ò–º–ø–æ—Ä—Ç–∏—Ä—É–π—Ç–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –∏–∑ —Ñ–∞–π–ª–∞ (—Ñ–æ—Ä–º–∞—Ç JSON):</p>
        <div style="border: 2px dashed #6a11cb; border-radius: 8px; padding: 20px; text-align: center; cursor: pointer; background: #f8f9fa; margin-bottom: 15px;">
          <span style="font-size: 36px;">üìÅ</span>
          <p style="margin: 10px 0; font-weight: 600; color: #2c3e50;">
            –ü–µ—Ä–µ—Ç–∞—â–∏—Ç–µ JSON —Ñ–∞–π–ª —Å—é–¥–∞
          </p>
          <p style="margin: 0; color: #7f8c8d; font-size: 14px;">–∏–ª–∏ –Ω–∞–∂–º–∏—Ç–µ –¥–ª—è
            –≤—ã–±–æ—Ä–∞ —Ñ–∞–π–ª–∞
          </p>
          <input
            type="file"
            id="importFileInput"
            accept=".json"
            style="display: none;"
          >
        </div>
        <div class="hint">–ò–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª–µ–Ω—ã –∫
          —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º
        </div>
      </div>

      <div class="form-group">
        <h4>–û—á–∏—Å—Ç–∏—Ç—å –≤—Å–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è</h4>
        <p>–í–Ω–∏–º–∞–Ω–∏–µ: —ç—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ –Ω–µ–ª—å–∑—è –æ—Ç–º–µ–Ω–∏—Ç—å!</p>
        <button
          onclick="clearAllCustomImages()"
          class="btn btn-danger"
          style="width: 100%;"
        >
          üóëÔ∏è –£–¥–∞–ª–∏—Ç—å –≤—Å–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
        </button>
      </div>
    </div>

    <div class="modal-buttons">
      <button
        type="button"
        class="btn btn-secondary"
        onclick="closeManageImagesModal()"
      >–ó–∞–∫—Ä—ã—Ç—å
      </button>
    </div>
  </div>
</div>

<!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ —Ç–æ—á–∫–µ –ø–µ—Ä–µ—Å–µ—á–µ–Ω–∏—è -->
<div
  id="intersectionPointModal"
  class="modal"
>
  <div class="modal-content" style="max-width: 800px; max-height: 80vh;">
    <div class="modal-header">
      <h2 class="modal-title">üìå –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ç–æ—á–∫–µ –ø–µ—Ä–µ—Å–µ—á–µ–Ω–∏—è</h2>
      <button class="close-modal" onclick="closeIntersectionPointModal()">√ó</button>
    </div>

    <div id="intersectionPointInfo">
      <!-- –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –∑–∞–ø–æ–ª–Ω—è–µ—Ç—Å—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ —Ç–æ—á–∫–µ -->
    </div>

    <div class="modal-buttons">
      <button type="button" class="btn btn-secondary" onclick="closeIntersectionPointModal()">–ó–∞–∫—Ä—ã—Ç—å</button>
    </div>
  </div>
</div>

<!-- –ö–æ–Ω—Ç–µ–∫—Å—Ç–Ω–æ–µ –º–µ–Ω—é -->
<div
  id="contextMenu"
  class="context-menu"
>
  <div
    class="context-menu-item"
    onclick="copyObject()"
  ><span>üìã</span> –ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å
  </div>
  <div
    class="context-menu-item"
    onclick="pasteObject()"
  ><span>üìÑ</span> –í—Å—Ç–∞–≤–∏—Ç—å
  </div>
  <div class="context-menu-divider"></div>
  <div
    class="context-menu-item"
    onclick="duplicateObject()"
  ><span>üîÅ</span> –î—É–±–ª–∏—Ä–æ–≤–∞—Ç—å
  </div>
  <div
    class="context-menu-item"
    onclick="bringObjectToFront()"
  ><span>‚¨ÜÔ∏è</span> –ù–∞ –ø–µ—Ä–µ–¥–Ω–∏–π –ø–ª–∞–Ω
  </div>
  <div
    class="context-menu-item"
    onclick="sendObjectToBack()"
  ><span>‚¨áÔ∏è</span> –ù–∞ –∑–∞–¥–Ω–∏–π –ø–ª–∞–Ω
  </div>
  <div class="context-menu-divider"></div>
  <div
    class="context-menu-item"
    onclick="deleteObject()"
  ><span>üóëÔ∏è</span> –£–¥–∞–ª–∏—Ç—å
  </div>
</div>

<!-- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è -->
<div id="notificationContainer"></div>

<script src="./js-23-01-26/js23-01-26.js"></script>
</body>
</html>